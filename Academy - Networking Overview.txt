
ISPs:

DNS -> Internet -> ISP

Then ISPs connect to either home or companies:
Home:

ISP -> Router -> Devices

Companies:

ISP -> Router -> Switch (Here we enter the company's network):
1. Switch -> DMZ -> Web server
2. Switch -> IP Phone
3. Switch -> Printer
4. Switch -> Client Host
The switch and router in this case should be on an administrative network
The printer should be on a separate network, and the client hosts on a separate network
The printer should also never talk to the Internet

Website: Uniform Resource Locater (URL)
This is considered as a Fully Qualified Domain Name (FQDN)

Consider: We visit a website
A website can be thought of as an address
The router is an way for us to connect to the Internet
Our packets that we send to the router will go through the ISP.

The ISP will observe the DNS to resolve the corresponding IP address.

Wide Area Network (WAN): known as the Internet

Local Area Network (LAN) / Wide Local Area Network (WLAN)
No difference between them.
Typically, they will assign IP addresses to your device.
This is done via a process called Dynamic Host Control Protocol (DHCP)

Virtual Private Network (VPN)
There are 3 kinds:
1. Site-to-site VPN
    Used to join networks in different places together; to be treated as Local
2. Remote Access VPN
    This makes the person intending to join the VPN have his client create a software-based
    representation that mimics a network interface card (NIC) found in computers.
    This is a virtual network interface.
    After creation of this interface, the person can just access the remote network as
    though his computer is part of the network.

    An example is HackTheBox, which uses OpenVPN. This OpenVPN client creates a TUN adapter
    (TUN stands for tunnel) which enables us to join the labs.

Typically, when devices connect to a VPN, the device creates a routing table that will
determine how traffic flows. This table shows which IP addresses are accessible within the
network and which ones are not. Those that are not are accessed through the internet.

In a Split-Tunnel VPN, this routing table only creates routes for required specific networks
that can only be access via the VPN. So, other routes, other addresses, will all proceed to the
internet from the client-side. Hence it is called split-tunnel, because there are two tunnels
that are inaccessible from each other. HackTheBox uses this which promotes privacy.

In the case of company networks, Split-Tunnel VPNs are not recommended since if the client
is infected with malware, it will be harded to debug

3. SSL VPN

This is a VPN that is more associated with corporate networks than home networks.
This uses the SSL/TLS protocol to provide secure remote access to private networks.
The process of SSL VPNs:
    1. Your device connects to the SSL VPN server using a web browser or a dedicated
    SSL VPN client software.
    2. Then, your browser provides required authentication credentials to the SSL VPN server to be 
    authenticated.
    3. Once authenticated, the SSL VPN server will establish a secure SSL/TLS connection
    with your client. This connection encrypts all data flows between the client and the server

SSL VPN servers are literally dedicated computers that sit in a company's server rack, that handles
the exchange of cryptographic keys with clients that want to interact with the company's internal network.




Global Area Network (GAN)

The Internet is an example of this. Huge companies maintain their own isolated networks that can
span across countries (has many WANs), and are considered GANs. Typically undersea cables or satellite
transmission


Metropolitan Area Network (MAN)

Connects multiple LANs.
Typically, these are individual branches of a company connected to a MAN via leased lines.


Personal Area Network (PAN) or Wireless Personal Area Network (WPAN) 
Example is mobile hotspots


Network Topology
This is a term to refer to the arrangement of logical connections of devices in a network.
Includes clients, servers, network components like routers, switches, bridges.

Has 3 main areas:

1. Connections
    Wired and Wireless.
    Wired will include the cable types like coaxial cable, twisted pair cables ...
    Wireless will include the different types too: Wi-Fi, Cellular, Satellite...

2. Nodes (Network Interface Controllers)
    These are like connection points:
    Repeaters, hubs, firewalls, switches, routers, gateways, bridges...

3. Classification
    Has a few types:
    Point-to-point, bus, ring, star, mesh, daisy-chain...


Point-to-point Topology
A straightforward physical link connects two devices.
Not to confuse with peer-to-peer architecture.

Bus Topology
No central network component; every host can control the signals sent.
One host sends; others evaluate

Star Topology
All hosts connect to one central network component. Typically a hub, router or switch.
This central network component will redirect data to intended devices.

Ring Topology
For each host in a ring arrangement: one cable enters and one cable leaves.
Coordination is done via a protocol all hosts agree on.

Mesh Topology
This is situational. There are two general structures: fully-meshed and partially-meshed.
For a fully-meshed structure: this is like a complete graph.
Used in WAN to ensure high reliability and stability.
This setup: important network nodes like routers can be networked together. If one fails,
others can work without problems.

In a partially-meshed structure, each endpoint is connected by only one connection.

Tree Topology
Often used in large companies.
The server is the root, then its childrens are ethernet switches, then host computers.

Daisy Chain Topology
Often used in automation technology.
A computer connects to a computer connects to another computer like a tree with one child only.







Proxies
A proxy is just an intermediary device like a middleman that must be able to inspect data flowing
through it.
If it cannot inspect data through it; it is called a gateway.
Generally operates in the application layer; layer 7.


Dedicated Proxy / Forward Proxy
This is a device that forwards your requests.
Because as per the definition of proxies, the requests can be inspected and modified before forwarding.

In corporations, these are known as web filters. Malware attempting to communicate with command-and-control
(C2) servers or malicious websites must first bypass the proxy server.

Proxy-aware malware: These are malware that can recognise the above; and will rely on the underlying
operating system's network stack, such as WinSock in Windows, to establish network connections.
This means that malware can easily bypass the proxy server and communicate with external servers.

Most web browsers have a setting: System proxy. This means that requests made by these browsers will go
through system-configured proxies.
If the malware utilizes WinSock (Native Windows API), it will likely be proxy aware without any additional
code.

A browser that does not follow this proxy setting is Firefox.
It does not use WinSock and instead uses libcurl, which is its own networking library.
If a malware wishes to target Firefox, it has to change the proxy settings to use libcurl.

Alternative to the above's approach, an attacker can write a malware using DNS as a C2 mechanism.
However, this is combatted if the organisation monitors the DNS via tools like Sysmon.

Burp Suite is a tool that cybersecurity professionals use to analyse packets between web applications and 
web browsers. It uses a proxy server as an intercepting server between the browser and application.

This enables users to analyse and manipulate web traffic in real-time; and or inspect individual requests
and responses.
Burp Suite also has other tools that can help detect vulnerabilities.



Reverse Proxy
Reverse functionality of a forward proxy. Filters incoming ones.
Example is CloudFlare. Idea is that it reads incoming requests. CloudFlare is used for the reason that they
can absorb a lot of DDoS attacks via their mechanisms implemented: some examples:
1. Spreads out the entire network across the globe via dispersion of DDoS attack. Uses an Anycast network.
2. Traffic filtering
3. Enhanced network infrastructure that better deals with such attacks on different network layers.
4. AI systems to adapt to attack patterns.
5. Real-time monitoring and response
and many more...

This concept of reverse proxy is useful if you want to open up a backdoor - set it on a port. When a client
connects to this port, forward the client's data to the attacker via this same port.
This is useful for bypassing firewalls or logging.

If an attacker also gets access somehow to the system via SSH - a reverse proxy can be set up to send back
web requests through an SSH tunnel. This will evade IDS detection.



Web Application Firewall (WAF)
ModSecurity is a open-source example.
Such a firewall is meant to protect web applications from various attacks and vulnerabilities.

A WAF simply just monitors the flow of HTTP or HTTPS traffic through them and has tools to deal with
suspicious behaviours.


All proxies can either be transparent or not. If transparent; the client will not know about its existence.
This is just a setting.
Example of non-transparent proxies: enterprise networks, corporate environments, and public Wi-Fi hotspots.
Centralised proxy servers are dedicated to authenticate and give access.




Networking Model
7 layers and they describe data flow through them.

Regarding data flow, inter-layer communication utilises a format called a Protocol Data Unit (PDU).

Moving up the layers: Sender
Every layer will adds its own header and footer to the data. Then this new whole chunk becomes the data that
is sent the next layer.

Moving down the layer: Receiver
The reverse is done: strip away the headers off the data one-by-one as you go down the layers.

The concept of wrapping the data with additional information as it travels up is called encapsulation.

